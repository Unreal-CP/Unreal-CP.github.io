---
title: Lyraæ—¥å¿—
description: Lyraæ—¥å¿—
author: cotes
date: 2025-10-21 23:33:00 +0800
categories: [UE5, Lyra, Other]
tags: [ue,lyra]
pin: true
math: true
mermaid: true
---

# è™šå¹»æ—¥å¿—å­¦ä¹ 
## 1.Lyraåˆ›å»ºæ—¥å¿—å®šä¹‰
**åœ¨.hé‡Œé¢å†™**
``` cpp
LYRAGAME_API DECLARE_LOG_CATEGORY_EXTERN(LogLyra, Log, All);
```
**åœ¨.cppé‡Œé¢å†™**
``` cpp
DEFINE_LOG_CATEGORY(LogLyra);
```
è¿™æ ·å®šä¹‰çš„æ—¥å¿—å¯ä»¥åœ¨å…¶ä»–æ–‡ä»¶è¿›è¡Œä½¿ç”¨.
éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶æœ‰:
### å¤´æ–‡ä»¶(.h)
LyraEditor.h

```cpp
#pragma once
#include "Logging/LogMacros.h"
DECLARE_LOG_CATEGORY_EXTERN(LogLyraEditor, Log, All);
```

LyraGamePhaseLog.h
```cpp
#pragma once
#include "Logging/LogMacros.h"
DECLARE_LOG_CATEGORY_EXTERN(LogLyraGamePhase, Log, All);
```

LyraLogChannels.h
```cpp
//è‡ªå®šä¹‰æ—¥å¿—åˆ†ç±»,å¿«é€Ÿå®šä¹‰é—®é¢˜æ‰€åœ¨
LYRAGAME_API DECLARE_LOG_CATEGORY_EXTERN(LogLyra, Log, All);
LYRAGAME_API DECLARE_LOG_CATEGORY_EXTERN(LogLyraExperience, Log, All);
LYRAGAME_API DECLARE_LOG_CATEGORY_EXTERN(LogLyraAbilitySystem, Log, All);
LYRAGAME_API DECLARE_LOG_CATEGORY_EXTERN(LogLyraTeams, Log, All);
```

LyraCheatManager.h
```cpp
DECLARE_LOG_CATEGORY_EXTERN(LogLyraCheat, Log, All);
```

LyraGameSettingRegistry.h
```cpp
DECLARE_LOG_CATEGORY_EXTERN(LogLyraGameSettingRegistry, Log, Log);
```

LyraReplicationGraph.h
```cpp
DECLARE_LOG_CATEGORY_EXTERN(LogLyraRepGraph, Display, All);
```
### æºæ–‡ä»¶(.cpp)
LyraEditor.cpp
```cpp
DEFINE_LOG_CATEGORY(LogLyraEditor);
```
LyraLogChannels.cpp
```cpp
#include "LyraLogChannels.h"

DEFINE_LOG_CATEGORY(LogLyra);
DEFINE_LOG_CATEGORY(LogLyraExperience);
DEFINE_LOG_CATEGORY(LogLyraAbilitySystem);
DEFINE_LOG_CATEGORY(LogLyraTeams);
```

LyraCheatManager.cpp
```cpp
DEFINE_LOG_CATEGORY(LogLyraCheat);
```

LyraGameSettingRegistry.cpp
```cpp
DEFINE_LOG_CATEGORY(LogLyraGameSettingRegistry);
```

LyraReplicationGraph.cpp
```cpp
E_LOG_CATEGORY( LogLyraRepGraph );
```


## 2.å¤ä¹ éƒ¨åˆ†çŸ¥è¯†ç‚¹

è¯¥æ—¥å¿—æ–‡ä»¶ä½äºå¼•æ“æºç ä½ç½®: `\Epic\UE\UE_5.6\Engine\Source\Runtime\Core\Public\Logging\LogMacros.h`

### 1.å¸¦æœ‰staticçš„åŒºåˆ†
æ³¨æ„åŒºåˆ†
``` cpp
DEFINE_LOG_CATEGORY_STATIC(SourceFilterPresets, Display, Display);
```
å¸¦æœ‰Staticçš„æ—¥å¿—å®šä¹‰å®`DEFINE_LOG_CATEGORY_STATIC`
ä¸€ä¸ªå®ï¼Œç”¨äºå°†æ—¥å¿—ç±»åˆ«å®šä¹‰ä¸º C++ ä¸­çš„â€œé™æ€â€å˜é‡ã€‚æ­¤å®åº”ä»…åœ¨æºæ–‡ä»¶ä¸­å£°æ˜ã€‚ä»…èƒ½åœ¨è¯¥å•ä¸ªæ–‡ä»¶ä¸­è®¿é—®ã€‚

`DEFINE_LOG_CATEGORY_STATIC`

### 2.å¤šçº¿ç¨‹ä¸å®‰å…¨

ä½ å¯ä»¥ç»§æ‰¿ `FOutputDevice`ï¼Œå®ç°ä½ è‡ªå·±çš„è¾“å‡ºç±»ã€‚


### 3.æ—¥å¿—è¯¦ç»†çº§åˆ«

| æ—¥å¿—è¯¦ç»†çº§åˆ« | æ‰“å°åœ¨æ§åˆ¶å°ä¸­ | æ‰“å°åœ¨ç¼–è¾‘å™¨æ—¥å¿—ä¸­ | æ–‡æœ¬é¢œè‰² | å…¶ä»–ä¿¡æ¯ |
|-------------|----------------|-------------------|----------|----------|
| è‡´å‘½ï¼ˆFatalï¼‰ | âœ… æ˜¯ | âŒ ä¸é€‚ç”¨ | âŒ ä¸é€‚ç”¨ | ä¼šè¯å´©æºƒ |
| é”™è¯¯ï¼ˆErrorï¼‰ | âœ… æ˜¯ | âœ… æ˜¯ | ğŸ”´ çº¢è‰² | âŒ ä¸é€‚ç”¨ |
| è­¦å‘Šï¼ˆWarningï¼‰ | âœ… æ˜¯ | âœ… æ˜¯ | ğŸŸ¡ é»„è‰² | âŒ ä¸é€‚ç”¨ |
| æ˜¾ç¤ºï¼ˆDisplayï¼‰ | âœ… æ˜¯ | âœ… æ˜¯ | âš« ç°è‰² | âŒ ä¸é€‚ç”¨ |
| æ—¥å¿—ï¼ˆLogï¼‰ | âŒ å¦ | âœ… æ˜¯ | âš« ç°è‰² | âŒ ä¸é€‚ç”¨ |
| å†—é•¿ï¼ˆVerboseï¼‰ | âŒ å¦ | âŒ å¦ | âŒ ä¸é€‚ç”¨ | âŒ ä¸é€‚ç”¨ |
| æå…¶å†—é•¿ï¼ˆVeryVerboseï¼‰ | âŒ å¦ | âŒ å¦ | âŒ ä¸é€‚ç”¨ | å¯ä½¿ç”¨æ—¥å¿—æ©ç å’Œç‰¹æ®Šæšä¸¾å€¼è®¾ç½®æ–‡æœ¬é¢œè‰² |

æ³¨æ„**Fatal**ä¼šå¯¼è‡´å´©æºƒ
å¯¹åº”çš„æ—¥å¿—å®šä¹‰åœ¨`E:\Epic\UE\UE_5.6\Engine\Source\Runtime\Core\Public\Logging\LogVerbosity.h`

## 3.è®²è§£è·å–ä¸Šä¸‹æ–‡å¯¹è±¡æ–¹æ³•
``` cpp
FString GetClientServerContextString(UObject* ContextObject = nullptr);
```
è¯¥å‡½æ•°åœ¨**LyraExperienceManagerComponent.h**ä¸­è°ƒç”¨,ç”¨æ¥æ‰“å°Experienceçš„åŠ è½½æ—¥å¿—.ä¼ é€’çš„å¯¹è±¡æ˜¯GameState.è¯¥å¯¹è±¡å…·æœ‰ç½‘ç»œåŒæ­¥çš„å±æ€§.

æ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯è¿™é‡Œé¢æœ‰ä¸€ä¸ªå…¨å±€å˜é‡GPlayInEditorContextString
``` cpp
#if WITH_EDITOR
// A debugging aid set when we switch out different play worlds during Play In Editor / PIE
// åœ¨â€œç¼–è¾‘å™¨ä¸­æ¸¸æˆâ€ï¼ˆPIEï¼‰æ¨¡å¼ä¸‹åˆ‡æ¢ä¸åŒçš„æ¸¸æˆåœºæ™¯æ—¶ä¼šå¯ç”¨æ­¤è°ƒè¯•è¾…åŠ©å·¥å…·é›†
ENGINE_API FString GPlayInEditorContextString(TEXT("invalid"));
#endif
```

å®ƒä¸»è¦æ˜¯åœ¨ç¼–è¾‘å™¨ä¸‹é€šè¿‡é€šè¿‡ä¸Šä¸‹æ–‡å¯¹è±¡è·å–è°ƒè¯•å­—æ®µ.
``` cpp
// Update the debugging aid GPlayInEditorContextString based on the current world context (does nothing in WITH_EDITOR=0 builds)
// æ ¹æ®å½“å‰çš„ä¸–ç•Œç¯å¢ƒæ›´æ–°è°ƒè¯•è¾…åŠ©å·¥å…· GPlayInEditorContextStringï¼ˆåœ¨ WITH_EDITOR=0 æ„å»ºæ¨¡å¼ä¸‹ä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼‰
ENGINE_API void UpdatePlayInEditorWorldDebugString(const FWorldContext* WorldContext);

// Returns the Debug string for a given world (Standalone, Listen Server, Client #, etc)
// è¿”å›æŒ‡å®šä¸–ç•Œçš„è°ƒè¯•å­—ç¬¦ä¸²ï¼ˆå¦‚ç‹¬ç«‹è¿è¡Œæ¨¡å¼ã€ç›‘å¬æœåŠ¡å™¨æ¨¡å¼ã€å®¢æˆ·ç«¯ç¼–å·ç­‰ï¼‰
ENGINE_API FString GetDebugStringForWorld(const UWorld* World);
```

å›åˆ°Lyraé¡¹ç›®ä¸­,<strong>UpdatePlayInEditorWorldDebugString()</strong>è¿™ä¸ªå‡½æ•°çš„ä¸»è¦è°ƒç”¨æ—¶é—´éƒ½æ˜¯åœ¨åœºæ™¯ä¸–ç•Œåˆ‡æ¢,åŠ è½½åœ°å›¾æ—¶è°ƒç”¨.

å›åˆ°Lyraé¡¹ç›®ä¸­,**GPlayInEditorContextString**åœ¨**UGameplayMessageSubsystem::BroadcastMessageInternal**ä¹Ÿæœ‰è®¿é—®.ä¸»è¦ä¸ºäº†è°ƒè¯•æ—¶,è·å–æ¶ˆæ¯å‘ç”Ÿçš„ä¸–ç•Œç±»å‹.

æ­¤å¤„è¡¥å……ä¸€æ®µå…³äºFWorldContextçš„æ³¨é‡Š,æ¥è‡ªå¼•æ“æºç :
``` txt
/** FWorldContext
 *	A context for dealing with UWorlds at the engine level. As the engine brings up and destroys world, we need a way to keep straight
 *	what world belongs to what.
 *
 *	WorldContexts can be thought of as a track. By default we have 1 track that we load and unload levels on. Adding a second context is adding
 *	a second track; another track of progression for worlds to live on. 
 *
 *	For the GameEngine, there will be one WorldContext until we decide to support multiple simultaneous worlds.
 *	For the EditorEngine, there may be one WorldContext for the EditorWorld and one for the PIE World.
 *
 *	FWorldContext provides both a way to manage 'the current PIE UWorld*' as well as state that goes along with connecting/travelling to 
 *  new worlds.
 *
 *	FWorldContext should remain internal to the UEngine classes. Outside code should not keep pointers or try to manage FWorldContexts directly.
 *	Outside code can still deal with UWorld*, and pass UWorld*s into Engine level functions. The Engine code can look up the relevant context 
 *	for a given UWorld*.
 *
 *  For convenience, FWorldContext can maintain outside pointers to UWorld*s. For example, PIE can tie UWorld* UEditorEngine::PlayWorld to the PIE
 *	world context. If the PIE UWorld changes, the UEditorEngine::PlayWorld pointer will be automatically updated. This is done with AddRef() and
 *  SetCurrentWorld().
 *
 */
 ```
 ```txt
/*
*  FWorldContext æ˜¯ç”¨äºåœ¨å¼•æ“å±‚é¢å¤„ç† UWorld çš„ä¸€ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒã€‚å½“å¼•æ“å¯åŠ¨å’Œé”€æ¯ä¸–ç•Œæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹æ³•æ¥æ˜ç¡®åŒºåˆ†å“ªäº›ä¸–ç•Œå±äºå“ªä¸ªä¸–ç•Œã€‚
*  WorldContext å¯ä»¥è¢«è§†ä¸ºä¸€æ¡è½¨é“ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè½¨é“ç”¨äºåŠ è½½å’Œå¸è½½å…³å¡ã€‚æ·»åŠ ç¬¬äºŒä¸ªä¸Šä¸‹æ–‡å°±æ˜¯æ·»åŠ ç¬¬äºŒæ¡è½¨é“ï¼›ä¸ºä¸–ç•Œæä¾›å¦ä¸€ä¸ªå­˜åœ¨çš„è¿›å±•è½¨é“ã€‚
*  å¯¹äºæ¸¸æˆå¼•æ“ï¼Œç›´åˆ°æˆ‘ä»¬å†³å®šæ”¯æŒå¤šä¸ªåŒæ—¶å­˜åœ¨çš„ä¸–ç•Œä¹‹å‰ï¼Œå°†åªæœ‰ä¸€ä¸ª WorldContextã€‚å¯¹äºç¼–è¾‘å™¨å¼•æ“ï¼Œå¯èƒ½ä¼šæœ‰ä¸€ä¸ªç”¨äºç¼–è¾‘å™¨ä¸–ç•Œå’Œä¸€ä¸ªç”¨äº PIE ä¸–ç•Œçš„ WorldContextã€‚
*  FWorldContext æä¾›äº†ç®¡ç†â€œå½“å‰çš„ PIE UWorld*â€çš„æ–¹æ³•ï¼Œä»¥åŠä¸è¿æ¥/å‰å¾€æ–°ä¸–ç•Œç›¸å…³çš„çŠ¶æ€ã€‚
*  FWorldContext åº”è¯¥ä¿æŒåœ¨ UEngine ç±»å†…éƒ¨ã€‚å¤–éƒ¨ä»£ç ä¸åº”ä¿ç•™æŒ‡é’ˆæˆ–ç›´æ¥ç®¡ç† FWorldContextã€‚å¤–éƒ¨ä»£ç ä»ç„¶å¯ä»¥å¤„ç† UWorld*ï¼Œå¹¶å°† UWorld* ä¼ é€’ç»™å¼•æ“çº§åˆ«çš„å‡½æ•°ã€‚å¼•æ“ä»£ç å¯ä»¥æ ¹æ®ç»™å®šçš„ UWorld* æŸ¥æ‰¾ç›¸å…³çš„ä¸Šä¸‹æ–‡ã€‚
*  ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼ŒFWorldContext å¯ä»¥ç»´æŠ¤å¤–éƒ¨å¯¹ UWorld* çš„æŒ‡é’ˆã€‚ä¾‹å¦‚ï¼ŒPIE å¯ä»¥å°† UWorld* UEditorEngine:ï¼šPlayWorld ä¸ PIE ä¸–ç•Œä¸Šä¸‹æ–‡å…³è”èµ·æ¥ã€‚å¦‚æœ PIE UWorld å‘ç”Ÿå˜åŒ–ï¼ŒUEditorEngine::PlayWorld æŒ‡é’ˆå°†è‡ªåŠ¨æ›´æ–°ã€‚è¿™æ˜¯é€šè¿‡è°ƒç”¨ AddRef() å’Œ SetCurrentWorld() æ¥å®ç°çš„ã€‚
*/

```

## å‚è€ƒæ–‡çŒ®
[è™šå¹»ä¸­çš„æ—¥å¿—è®°å½•](https://dev.epicgames.com/documentation/zh-cn/unreal-engine/logging-in-unreal-engine)
